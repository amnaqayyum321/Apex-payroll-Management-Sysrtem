<div class="candidates-form-container" *ngIf='title === "create" || title === "edit"'>
    <div class="candidates-form-card">
        <div class="form-header">
            <h2 class="form-title">{{title === 'create' ? 'Create New Candidate' : 'Edit Candidate'}} </h2>
            <p class="form-subtitle"> {{title === 'create' ? 'Define a new candidate' : 'Modify candidate details'}}
            </p>
        </div>

        <!-- Section 1: Basic Details -->
        <div class="form-section basic-details">
            <form class="section-form">
                <h3 class="section-heading">Basic Details</h3>

                <!-- Row 1: ID, First Name, Last Name -->
                <div class="form-row">
                    <div class="form-group">
                        <label class="input-label">Code <span class="required">*</span></label>
                        <input type="text" class="form-input" [(ngModel)]="candidate.code" name="id" required
                            [disabled]="title === 'edit'" />
                        <div class="error-msg" *ngIf="isSubmitted && !candidate.code">
                            Required field is missing
                        </div>
                    </div>
                    <div class="form-group" *ngIf="isFieldActive('first_name')">
                        <label class="input-label">First Name <span class="required">*</span></label>
                        <input type="text" class="form-input" [(ngModel)]="candidate.first_name" name="first_name"
                            required />
                        <div class="error-msg" *ngIf="isSubmitted && !candidate.first_name">
                            Required field is missing
                        </div>
                    </div>
                    <div class="form-group" *ngIf="isFieldActive('last_name')">
                        <label class="input-label">Last Name <span class="required">*</span></label>
                        <input type="text" class="form-input" [(ngModel)]="candidate.last_name" name="last_name"
                            required />
                        <div class="error-msg" *ngIf="isSubmitted && !candidate.last_name">
                            Required field is missing
                        </div>
                    </div>
                    <div class="form-group" *ngIf="isFieldActive('requisition')">
                        <label class="input-label">Requisition <span class="required">*</span></label>
                        <div class="custom-dropdown" (click)="toggleDropdown($event,'requisition')">
                            <div class="dropdown-selected">
                                <span>{{ requisitionDisplayValue || 'Select Requisition' }}</span>
                                <i class="fa-solid fa-chevron-down dropdown-arrow"
                                    [class.rotate]="activeDropdown==='requisition'"></i>
                            </div>
                            <div class="dropdown-options" *ngIf="activeDropdown==='requisition'">
                                <div *ngIf="requsitionDropDownValue.length > 0">
                                    <div class="dropdown-option" *ngFor="let r of requsitionDropDownValue"
                                        (click)="selectOption('requisition',r,$event)">
                                        {{ r.summary }}
                                    </div>
                                </div>
                                <div *ngIf="requsitionDropDownValue.length === 0" class="dropdown-option text-muted">
                                    No Requisitions Available
                                </div>
                            </div>
                        </div>
                        <div class="error-msg" *ngIf="isSubmitted && !candidate.requisition">
                            Required field is missing
                        </div>
                    </div>
                </div>


                <!-- Row 2: Requisition & Email -->
                <div class="form-row">


                    <div class="form-group" *ngIf="isFieldActive('email')">
                        <label class="input-label">Email</label>
                        <input type="email" class="form-input" [(ngModel)]="candidate.email" name="email"
                            placeholder="Enter Email" />
                        <div class="error-msg" *ngIf="isSubmitted && !candidate.email">
                            Required field is missing
                        </div>
                    </div>

                    <div class="form-group" *ngIf="isFieldActive('contact_number1')">
                        <label class="input-label">Contact Number 1</label>
                        <input type="text" class="form-input" [(ngModel)]="candidate.contact_number1"
                            name="contact_number1" placeholder="Enter Contact Number" />
                        <div class="error-msg" *ngIf="isSubmitted && !candidate.contact_number1">
                            Required field is missing
                        </div>
                    </div>
                </div>

                <!-- Row 3: Contact 2, Date of Application, Department -->
                <div class="form-row">
                    <div class="form-group" *ngIf="isFieldActive('contact_number2')">
                        <label class="input-label">Contact Number 2</label>
                        <input type="text" class="form-input" [(ngModel)]="candidate.contact_number2"
                            name="contact_number2" placeholder="Enter Contact Number" />
                        <div class="error-msg" *ngIf="isSubmitted && !candidate.contact_number2">
                            Required field is missing
                        </div>
                    </div>
                    <div class="form-group" *ngIf="isFieldActive('application_date')">
                        <label class="input-label">Date of Application</label>
                        <input type="date" class="form-input" [(ngModel)]="candidate.application_date"
                            name="application_date" />
                        <div class="error-msg" *ngIf="isSubmitted && !candidate.application_date">
                            Required field is missing
                        </div>
                    </div>
                    <!-- <div class="form-group">
                        <label class="input-label">Department</label>
                        <div class="custom-dropdown" (click)="toggleDropdown($event,'department')">
                            <div class="dropdown-selected">
                                <span>{{ candidate.department || 'Select Department' }}</span>
                                <i class="fa-solid fa-chevron-down dropdown-arrow"
                                    [class.rotate]="activeDropdown==='department'"></i>
                            </div>
                            <div class="dropdown-options" *ngIf="activeDropdown==='department'">
                                <div *ngIf="departmentDropDownValue.length > 0">
                                    <div class="dropdown-option" *ngFor="let d of departmentDropDownValue"
                                        (click)="selectOption('department',d.code,$event)">
                                        {{ d.name }}
                                    </div>
                                </div>
                                <div *ngIf="departmentDropDownValue.length === 0" class="dropdown-option text-muted">
                                    No Departments Available
                                </div>
                            </div>
                        </div>
                    </div> -->
                    <div class="form-group">
                        <label class="input-label">Designation</label>
                        <div class="custom-dropdown" (click)="toggleDropdown($event,'designation')">
                            <div class="dropdown-selected">
                                <span>{{ selectedDesignationDisplay || 'Select Designation' }}</span>
                                <i class="fa-solid fa-chevron-down dropdown-arrow"
                                    [class.rotate]="activeDropdown==='designation'"></i>
                            </div>
                            <div class="dropdown-options" *ngIf="activeDropdown==='designation'">
                                <div *ngIf="designationDropDownValue.length > 0">
                                    <div class="dropdown-option" *ngFor="let d of designationDropDownValue"
                                        (click)="selectOption('designation',d,$event)">
                                        {{ d.name }}
                                    </div>
                                </div>
                                <div *ngIf="designationDropDownValue.length === 0" class="dropdown-option text-muted">
                                    No Designations Available
                                </div>
                            </div>
                        </div>
                        <div class="error-msg" *ngIf="isSubmitted && !candidate.designation">
                            Required field is missing
                        </div>
                    </div>
                    <div class="form-group" *ngIf="isFieldActive('expected_doj')">
                        <label class="input-label"> Expected Date of Joining</label>
                        <input type="date" class="form-input" [(ngModel)]="candidate.expected_doj"
                            name="expected_doj" />
                        <div class="error-msg" *ngIf="isSubmitted && !candidate.expected_doj">
                            Required field is missing
                        </div>

                    </div>
                    <div class="form-group" *ngIf="isFieldActive('gender')">
                        <label class="input-label">Gender</label>
                        <div class="custom-dropdown" (click)="toggleDropdown($event,'gender')">
                            <div class="dropdown-selected">
                                <span>{{ candidate.gender || 'Select Gender' }}</span>
                                <i class="fa-solid fa-chevron-down dropdown-arrow"
                                    [class.rotate]="activeDropdown==='gender'"></i>
                            </div>
                            <div class="dropdown-options" *ngIf="activeDropdown==='gender'">
                                <div class="dropdown-option" *ngFor="let g of genderEnumArray"
                                    (click)="selectOption('gender',g,$event)">
                                    {{ g }}
                                </div>

                            </div>
                        </div>
                        <div class="error-msg" *ngIf="isSubmitted && !candidate.gender">
                            Required field is missing
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="input-label">LinkedIn URL</label>
                        <input type="url" class="form-input" [(ngModel)]="candidate.linkedin_url" name="linkedinUrl" />
                        <div class="error-msg" *ngIf="isSubmitted && !candidate.linkedin_url">
                            Required field is missing
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="input-label">Religion</label>
                        <div class="custom-dropdown" (click)="toggleDropdown($event,'religion')">
                            <div class="dropdown-selected">
                                <span>{{ candidate.religion || 'Select Religion' }}</span>
                                <i class="fa-solid fa-chevron-down dropdown-arrow"
                                    [class.rotate]="activeDropdown==='religion'"></i>
                            </div>
                            <div class="dropdown-options" *ngIf="activeDropdown==='religion'">
                                <div *ngIf="religionEnumArray.length > 0">
                                    <div class="dropdown-option" *ngFor="let r of religionEnumArray"
                                        (click)="selectOption('religion',r,$event)">
                                        {{ r }}
                                    </div>
                                </div>
                                <div *ngIf="religionEnumArray.length === 0" class="dropdown-option text-muted">
                                    No Religions Available
                                </div>
                            </div>
                        </div>
                        <div class="error-msg" *ngIf="isSubmitted && !candidate.religion">
                            Required field is missing
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="input-label">Country</label>
                        <div class="custom-dropdown" (click)="toggleDropdown($event,'country')">
                            <div class="dropdown-selected">
                                <span>{{ candidate.country || 'Select Country' }}</span>
                                <i class="fa-solid fa-chevron-down dropdown-arrow"
                                    [class.rotate]="activeDropdown==='country'"></i>
                            </div>
                            <div class="dropdown-options" *ngIf="activeDropdown==='country'">
                                <div class="dropdown-option" *ngFor="let d of countries"
                                    (click)="selectOption('country',d,$event)">
                                    {{ d }}
                                </div>

                            </div>
                        </div>
                        <div class="error-msg" *ngIf="isSubmitted && !candidate.country">
                            Required field is missing
                        </div>
                    </div>


                    <div class="form-group">
                        <label class="input-label">City</label>
                        <div class="custom-dropdown" (click)="toggleDropdown($event,'city')">
                            <div class="dropdown-selected">
                                <span>{{ candidate.city || 'Select City' }}</span>
                                <i class="fa-solid fa-chevron-down dropdown-arrow"
                                    [class.rotate]="activeDropdown==='city'"></i>
                            </div>
                            <div class="dropdown-options" *ngIf="activeDropdown==='city'">
                                <div class="dropdown-option" *ngFor="let d of cities"
                                    (click)="selectOption('city',d,$event)">
                                    {{ d }}
                                </div>
                            </div>
                        </div>
                        <div class="error-msg" *ngIf="isSubmitted && !candidate.city">
                            Required field is missing
                        </div>
                    </div>
                    <!-- <div class="form-group">
                        <label class="input-label">Category</label>
                        <div class="custom-dropdown" (click)="toggleDropdown($event,'category')">
                            <div class="dropdown-selected">
                                <span>{{ candidate.category || 'Select Category' }}</span>
                                <i class="fa-solid fa-chevron-down dropdown-arrow"
                                    [class.rotate]="activeDropdown==='category'"></i>
                            </div>
                            <div class="dropdown-options" *ngIf="activeDropdown==='category'">
                                <div class="dropdown-option" *ngFor="let d of categories"
                                    (click)="selectOption('category',d,$event)">
                                    {{ d }}
                                </div>
                            </div>
                        </div>
                    </div> -->
                    <!-- <div class="form-group" *ngIf="isFieldActive('onboarding_status')">
                        <label class="input-label">Onboarding Status</label>
                        <div class="custom-dropdown" (click)="toggleDropdown($event,'onboarding_status')">
                            <div class="dropdown-selected">
                                <span>{{ candidate.onboarding_status || 'Select Onboarding Status' }}</span>
                                <i class="fa-solid fa-chevron-down dropdown-arrow"
                                    [class.rotate]="activeDropdown==='onboarding_status'"></i>
                            </div>
                            <div class="dropdown-options" *ngIf="activeDropdown==='onboarding_status'">
                                <div class="dropdown-option" *ngFor="let os of onboardingStatusEnumArray"
                                    (click)="selectOption('onboarding_status',os,$event)">
                                    {{ os }}
                                </div>
                            </div>
                        </div>
                        <div class="error-msg" *ngIf="isSubmitted && !candidate.onboarding_status">
                            Required field is missing
                        </div>
                    </div>
                    <div class="form-group" *ngIf="isFieldActive('status')">
                        <label class="input-label">Candidate Status</label>
                        <div class="custom-dropdown" (click)="toggleDropdown($event,'status')">
                            <div class="dropdown-selected">
                                <span>{{ candidate.status || 'Select Candidate Status' }}</span>
                                <i class="fa-solid fa-chevron-down dropdown-arrow"
                                    [class.rotate]="activeDropdown==='status'"></i>
                            </div>
                            <div class="dropdown-options" *ngIf="activeDropdown==='status'">
                                <div class="dropdown-option" *ngFor="let s of candidateEnumArray"
                                    (click)="selectOption('status',s,$event)">
                                    {{ s }}
                                </div>
                            </div>
                        </div>
                        <div class="error-msg" *ngIf="isSubmitted && !candidate.status">
                            Required field is missing
                        </div>
                    </div> -->
                </div>
                <!-- <div class="form-row full-width">
                    <div class="form-group full-width">
                        <label class="input-label">Remarks</label>
                        <textarea class="form-input" [(ngModel)]="candidate.remarks" name="remarks" rows="2"></textarea>
                    </div>
                </div> -->

            </form>
        </div>

        <!-- Dynamic Fields Section -->
        <div class="form-section dynamic-fields"
            *ngIf="dynamicFieldsService.dynamicFields.length > 0 && (!sidebarTabs.length || activeTabId === 1)">
            <form class="section-form">
                <h3 class="section-heading">Additional Information</h3>
                <div class="form-row">
                    <ng-container *ngFor="let field of dynamicFieldsService.dynamicFields">
                        <div class="form-group" *ngIf="field.active">
                            <label class="input-label">
                                {{ field.label }}
                                <span class="required" *ngIf="field.required">*</span>
                            </label>

                            <!-- String Input -->
                            <input *ngIf="field.fieldType === 'STRING'" type="text" class="form-input"
                                [placeholder]="'Enter ' + field.label"
                                [(ngModel)]="dynamicFieldsService.dynamicFieldsData[field.fieldCode]"
                                [name]="field.fieldCode" [attr.maxlength]="field.maxLength">

                            <!-- Number Input -->
                            <input *ngIf="field.fieldType === 'NUMBER'" type="number" class="form-input"
                                [placeholder]="'Enter ' + field.label"
                                [(ngModel)]="dynamicFieldsService.dynamicFieldsData[field.fieldCode]"
                                [name]="field.fieldCode">
                            <!-- DECIMAL Input -->

                            <input *ngIf="field.fieldType === 'DECIMAL'" type="number" step="any" class="form-input"
                                [placeholder]="'Enter ' + field.label"
                                [(ngModel)]="dynamicFieldsService.dynamicFieldsData[field.fieldCode]"
                                [name]="field.fieldCode">

                            <!-- Date Input -->
                            <input *ngIf="field.fieldType === 'DATE'" type="date" class="form-input"
                                [(ngModel)]="dynamicFieldsService.dynamicFieldsData[field.fieldCode]"
                                [name]="field.fieldCode">

                            <!-- Email Input -->
                            <input *ngIf="field.fieldType === 'EMAIL'" type="email" class="form-input"
                                [placeholder]="'Enter ' + field.label"
                                [(ngModel)]="dynamicFieldsService.dynamicFieldsData[field.fieldCode]"
                                [name]="field.fieldCode">

                            <!-- Phone Input -->
                            <input *ngIf="field.fieldType === 'PHONE'" type="tel" class="form-input"
                                [placeholder]="'Enter ' + field.label"
                                [(ngModel)]="dynamicFieldsService.dynamicFieldsData[field.fieldCode]"
                                [name]="field.fieldCode">

                            <!-- URL Input -->
                            <input *ngIf="field.fieldType === 'URL'" type="url" class="form-input"
                                [placeholder]="'Enter ' + field.label"
                                [(ngModel)]="dynamicFieldsService.dynamicFieldsData[field.fieldCode]"
                                [name]="field.fieldCode">

                            <!-- Textarea -->
                            <textarea *ngIf="field.fieldType === 'TEXTAREA'" class="form-input" rows="3"
                                [placeholder]="'Enter ' + field.label"
                                [(ngModel)]="dynamicFieldsService.dynamicFieldsData[field.fieldCode]"
                                [name]="field.fieldCode" [attr.maxlength]="field.maxLength"></textarea>

                            <!-- Boolean Checkbox -->
                            <div *ngIf="field.fieldType === 'BOOLEAN'" class="checkbox-label">
                                <input class="checkbox-input" type="checkbox"
                                    [(ngModel)]="dynamicFieldsService.dynamicFieldsData[field.fieldCode]"
                                    [id]="'dynamic_' + field.fieldCode" [name]="field.fieldCode">
                                <span class="checkbox-text">{{ field.label }}</span>
                            </div>

                            <!-- Lookup Table Dropdown -->
                            <div *ngIf="field.fieldType === 'LOOKUP_TABLE'" class="custom-dropdown">
                                <div class="dropdown-selected"
                                    (click)="dynamicFieldsService.toggleDynamicDropdown(field, $event)">
                                    <span>{{ dynamicFieldsService.getSelectedDisplayText(field) }}</span>
                                    <i class="fa-solid fa-chevron-down dropdown-arrow"
                                        [class.rotate]="field.isDropdownOpen"></i>
                                </div>
                                <div class="dropdown-options" *ngIf="field.isDropdownOpen">
                                    <div class="dropdown-option" *ngFor="let option of field.options"
                                        (click)="dynamicFieldsService.selectDynamicOption(field, option, $event)">
                                        {{ option.displayText || option.name || option }}
                                    </div>
                                    <div class="dropdown-option text-muted"
                                        *ngIf="!field.options || field.options.length === 0">
                                        No options available
                                    </div>
                                </div>
                            </div>

                            <!-- Lookup Enum Dropdown -->
                            <div *ngIf="field.fieldType === 'LOOKUP_ENUM'" class="custom-dropdown">
                                <div class="dropdown-selected"
                                    (click)="dynamicFieldsService.toggleDynamicDropdown(field, $event)">
                                    <span>{{ dynamicFieldsService.dynamicFieldsData[field.fieldCode] || 'Select ' +
                                        field.label }}</span>
                                    <i class="fa-solid fa-chevron-down dropdown-arrow"
                                        [class.rotate]="field.isDropdownOpen"></i>
                                </div>
                                <div class="dropdown-options" *ngIf="field.isDropdownOpen">
                                    <div class="dropdown-option" *ngFor="let enumValue of field.enumValues"
                                        (click)="dynamicFieldsService.selectDynamicOption(field, enumValue, $event)">
                                        {{ enumValue }}
                                    </div>
                                    <div class="dropdown-option text-muted"
                                        *ngIf="!field.enumValues || field.enumValues.length === 0">
                                        No options available
                                    </div>
                                </div>
                            </div>
                        </div>
                    </ng-container>
                </div>
            </form>
        </div>

        <!-- Horizontal Tabs for ROW fields -->
        <div class="horizontal-tabs" *ngIf="sidebarTabs.length > 0">
            <div class="tabs-container">
                <button *ngFor="let tab of sidebarTabs" class="tab-button" [class.active]="activeTabId === tab.id"
                    (click)="setActiveTab(tab.id)">
                    {{ tab.name }}
                </button>
            </div>
        </div>

        <!-- ROW TABLE TABS Content -->
        <div *ngIf="sidebarTabs[activeTabId - 1]?.rowTableField" class="form-section tab-content-section">
            <form class="section-form">
                <h3 class="section-heading">{{ sidebarTabs[activeTabId - 1]?.name }}</h3>

                <div class="alert alert-warning"
                    *ngIf="!sidebarTabs[activeTabId - 1]?.rowTableField?.rowColumns || sidebarTabs[activeTabId - 1]?.rowTableField?.rowColumns.length === 0">
                    <i class="fa fa-exclamation-triangle"></i> No row columns found for this table.
                </div>

                <!-- Single Field Set (Form for one entry) -->
                <div class="form-row"
                    *ngIf="sidebarTabs[activeTabId - 1]?.rowTableField?.rowColumns && sidebarTabs[activeTabId - 1]?.rowTableField?.rowColumns.length > 0">
                    <ng-container *ngFor="let column of sidebarTabs[activeTabId - 1]?.rowTableField?.rowColumns">
                        <div class="form-group">
                            <label class="input-label">
                                {{ column.label || column.name }}
                                <span class="required" *ngIf="column.required">*</span>
                            </label>

                            <!-- String Input -->
                            <input *ngIf="column.fieldType === 'STRING'" type="text" class="form-input"
                                [placeholder]="'Enter ' + (column.label || column.name)"
                                [(ngModel)]="column.selectedValue" [name]="column.fieldCode"
                                [attr.maxlength]="column.maxLength">

                            <!-- Number Input -->
                            <input *ngIf="column.fieldType === 'NUMBER'" type="number" class="form-input"
                                [placeholder]="'Enter ' + (column.label || column.name)"
                                [(ngModel)]="column.selectedValue" [name]="column.fieldCode">
                            
                            <!-- DECIMAL Input -->
                            <input *ngIf="column.fieldType === 'DECIMAL'" type="number" step="any" class="form-input"
                                [placeholder]="'Enter ' + (column.label || column.name)"
                                [(ngModel)]="column.selectedValue" [name]="column.fieldCode">
                            
                            <!-- Date Input -->
                            <input *ngIf="column.fieldType === 'DATE'" type="date" class="form-input"
                                [(ngModel)]="column.selectedValue" [name]="column.fieldCode">

                            <!-- Email Input -->
                            <input *ngIf="column.fieldType === 'EMAIL'" type="email" class="form-input"
                                [placeholder]="'Enter ' + (column.label || column.name)"
                                [(ngModel)]="column.selectedValue" [name]="column.fieldCode">

                            <!-- Phone Input -->
                            <input *ngIf="column.fieldType === 'PHONE'" type="tel" class="form-input"
                                [placeholder]="'Enter ' + (column.label || column.name)"
                                [(ngModel)]="column.selectedValue" [name]="column.fieldCode">

                            <!-- URL Input -->
                            <input *ngIf="column.fieldType === 'URL'" type="url" class="form-input"
                                [placeholder]="'Enter ' + (column.label || column.name)"
                                [(ngModel)]="column.selectedValue" [name]="column.fieldCode">

                            <!-- Textarea -->
                            <textarea *ngIf="column.fieldType === 'TEXTAREA'" class="form-input" rows="3"
                                [placeholder]="'Enter ' + (column.label || column.name)"
                                [(ngModel)]="column.selectedValue" [name]="column.fieldCode"
                                [attr.maxlength]="column.maxLength"></textarea>

                            <!-- Boolean Checkbox -->
                            <div *ngIf="column.fieldType === 'BOOLEAN'" class="checkbox-label">
                                <input class="checkbox-input" type="checkbox" [(ngModel)]="column.selectedValue"
                                    [name]="column.fieldCode" [id]="'row_' + column.fieldCode">
                                <span class="checkbox-text">{{ column.label }}</span>
                            </div>

                            <!-- Lookup Table Dropdown -->
                            <div *ngIf="column.fieldType === 'LOOKUP_TABLE'" class="custom-dropdown">
                                <div class="dropdown-selected"
                                    (click)="dynamicFieldsService.toggleRowColumnDropdown(column, $event)">
                                    <span>{{ dynamicFieldsService.getRowColumnDisplayText(column) }}</span>
                                    <i class="fa-solid fa-chevron-down dropdown-arrow"
                                        [class.rotate]="column.isDropdownOpen"></i>
                                </div>
                                <div class="dropdown-options" *ngIf="column.isDropdownOpen">
                                    <div class="dropdown-option" *ngFor="let option of column.options"
                                        (click)="dynamicFieldsService.selectRowColumnOption(column, option, $event)">
                                        {{ option.displayText || option.name || option }}
                                    </div>
                                    <div class="dropdown-option text-muted"
                                        *ngIf="!column.options || column.options.length === 0">
                                        No options available
                                    </div>
                                </div>
                            </div>

                            <!-- Lookup Enum Dropdown -->
                            <div *ngIf="column.fieldType === 'LOOKUP_ENUM'" class="custom-dropdown">
                                <div class="dropdown-selected"
                                    (click)="dynamicFieldsService.toggleRowColumnDropdown(column, $event)">
                                    <span>{{ column.selectedValue || 'Select ' + (column.label || column.name) }}</span>
                                    <i class="fa-solid fa-chevron-down dropdown-arrow"
                                        [class.rotate]="column.isDropdownOpen"></i>
                                </div>
                                <div class="dropdown-options" *ngIf="column.isDropdownOpen">
                                    <div class="dropdown-option" *ngFor="let enumValue of column.enumValues"
                                        (click)="dynamicFieldsService.selectRowColumnOption(column, enumValue, $event)">
                                        {{ enumValue }}
                                    </div>
                                    <div class="dropdown-option text-muted"
                                        *ngIf="!column.enumValues || column.enumValues.length === 0">
                                        No options available
                                    </div>
                                </div>
                            </div>
                        </div>
                    </ng-container>
                </div>

                <!-- Add Button -->
                <div class="form-row" style="justify-content: flex-end; margin-top: 10px;">
                    <button type="button" class="btn btn-primary" (click)="addRowToTable()" 
                            style="background: #4CAF50; border: none; padding: 8px 20px; border-radius: 4px; color: white; cursor: pointer;">
                        <i class="fa fa-plus"></i> Add
                    </button>
                </div>

                <!-- Saved Entries Table -->
                <div *ngIf="getSavedRowsForCurrentTab().length > 0" style="margin-top: 20px;">
                    <h4 class="section-heading" style="font-size: 16px; margin-bottom: 10px;">Saved Entries</h4>
                    <div style="overflow-x: auto; width: 100%;">
                        <table class="table" style="width: 100%; min-width: 800px; border-collapse: collapse; background: #1e293b; border-radius: 8px;">
                            <thead>
                                <tr style="background: #334155; color: #94a3b8;">
                                    <th *ngFor="let column of sidebarTabs[activeTabId - 1]?.rowTableField?.rowColumns" 
                                        style="padding: 10px; text-align: left; border-bottom: 2px solid #475569;">
                                        {{ column.label || column.name }}
                                    </th>
                                    <th style="padding: 10px; text-align: center; border-bottom: 2px solid #475569;">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let row of getSavedRowsForCurrentTab(); let i = index" 
                                    style="border-bottom: 1px solid #334155;">
                                    <td *ngFor="let column of sidebarTabs[activeTabId - 1]?.rowTableField?.rowColumns" 
                                        style="padding: 10px;">
                                        <span *ngIf="column.fieldType === 'BOOLEAN'">
                                            {{ row[column.fieldCode] ? 'Yes' : 'No' }}
                                        </span>
                                        <span *ngIf="column.fieldType === 'DATE'">
                                            {{ row[column.fieldCode] | date:'dd/MM/yyyy' }}
                                        </span>
                                        <span *ngIf="column.fieldType !== 'BOOLEAN' && column.fieldType !== 'DATE'">
                                            {{ row[column.fieldCode] || '—' }}
                                        </span>
                                    </td>
                                    <td style="padding: 10px; text-align: center;">
                                        <button type="button" 
                                                (click)="removeRowFromTable(sidebarTabs[activeTabId - 1]?.rowTableField?.fieldCode, i)"
                                                style="background: #ef4444; border: none; padding: 5px 10px; border-radius: 4px; color: white; cursor: pointer;">
                                            <i class="fa fa-trash"></i>
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </form>
        </div>

        <!-- Action Buttons -->
        <div class="form-actions">
            <button type="button" class="btn btn-cancel" (click)="onCancel()"> Cancel</button>

            <button type="submit" class="btn btn-submit" (click)="saveCandidate()">{{title === 'create' ? 'Create
                Candidate' : (title === 'edit' ? 'Update Candidate' : 'Save Candidate')}}</button>
        </div>

    </div>
</div>




<div *ngIf='title === "view"'>


    <section class="container-fluid p-0">
        <div class="d-flex justify-content-between mb-3">
            <div class="page-title ">
                <i class="fa-solid fa-house"></i>
                <span style="font-weight: 700; color: #566f9e;">-</span>
                <span>View All Candidates List</span>
            </div>

            <!-- Items Per Page + Search -->
            <div class="top-controls d-flex align-items-center">

                <!-- Items Per Page -->
                <!-- <div class="items-per-page">
          <label>Items per page:</label>
          <select class="form-select" [(ngModel)]="itemsPerPage" (change)="onItemsPerChange($event)">
            <option [ngValue]="5">5</option>
            <option [ngValue]="8">8</option>
            <option [ngValue]="10">10</option>
            <option [ngValue]="20">20</option>
          </select>
        </div> -->
                <!-- Search -->
                <!-- Search -->
                <!-- <div class="search-wrapper ms-auto">
          <input type="text" class="form-control" placeholder="Search..." (ngModelChange)="updatePagination()" />
          <i class="fa fa-search search-icon"></i>
        </div> -->
            </div>

            <div>
                <button routerLink="/panel/onboarding/create-new-candidates" class="creat-btn">Create Candidate</button>
            </div>
        </div>
        <section class="table-main-div ">
            <div class="rounded-2xl text-gray-200 overflow-x-auto pt-4">
                <table class="min-w-full text-sm border-separate border-spacing-y-2 ">
                    <thead>
                        <tr class="text-gray-400 text-left text-xs uppercase tracking-wider">

                            <th class="px-3 py-2">Candidate Name</th>
                            <th class="px-3 py-2">Email</th>
                            <th class="px-3 py-2">Job Title</th>
                            <th class="px-3 py-2">Onboarding Status</th>
                            <th class="px-3 py-2">Candidate Status</th>
                            <th class="px-3 py-2">Active</th>

                            <th class="px-3 py-2">Actions</th>





                        </tr>
                    </thead>

                    <tbody>
                        <tr *ngFor="let c of candidateTableListArray; let i = index"
                            class="bg-[#1e293b] hover:bg-[#27354a] rounded-lg">
                            <td class="px-3 py-3 font-medium">{{ c.first_name }} {{ c.last_name }}</td>
                            <td class="px-3 py-3 font-medium">{{ c.email || '—'}}</td>
                            <td class="px-3 py-3 font-medium">{{ c.job_title_name || '—' }}</td>
                            <td class="px-3 py-3 font-medium">{{ c.onboarding_status|| '—' }}</td>
                            <td class="px-3 py-3 font-medium">{{ c.status || '—'}}</td>
                            <td class="px-3 py-3 font-medium">{{ c.is_active}}</td>

                            <td class="px-3 py-3 font-medium">
                                <i class="fa fa-edit" style="cursor:pointer; margin-right: 10px;"
                                    [routerLink]="['/panel/onboarding/edit-candidates']"
                                    [queryParams]="{id: c.public_id ,currentPage:currentPage}"></i>
                                <i class="fa fa-trash" style="cursor:pointer; " (click)="deleteCandidate(c)"></i>
                            </td>







                        </tr>
                    </tbody>
                </table>

            </div>

            <app-pagination [currentPage]="currentPage+1" [totalPages]="totalPages" [totalPagesArray]="totalPagesArray"
                (pageChange)="changePage($event)">
            </app-pagination>
        </section>
    </section>
</div>